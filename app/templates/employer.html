<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè¢ AI Employer Dashboard - Job Matching Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 24px;
            border-radius: 16px;
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            font-size: 2rem;
            background: linear-gradient(45deg, #fff, #ecf0f1);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 4px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 0.9rem;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .role-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            background: linear-gradient(45deg, #e67e22, #d35400);
            color: white;
            box-shadow: 0 2px 8px rgba(230, 126, 34, 0.3);
        }
        
        .ai-status {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            font-size: 0.8rem;
        }
        
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #27ae60;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }
        
        .stat-card.ai-powered {
            border-left: 4px solid #e67e22;
        }
        
        .stat-card.ai-powered::before {
            content: 'ü§ñ';
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 1.2em;
            opacity: 0.7;
        }
        
        .stat-card h3 {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-card .number {
            font-size: 2.5rem;
            font-weight: 700;
            color: white;
            margin-bottom: 8px;
            background: linear-gradient(45deg, #fff, #ecf0f1);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-card .subtitle {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .action-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }
        
        .action-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .action-card .icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
            display: block;
        }
        
        .action-card h4 {
            margin-bottom: 8px;
            font-size: 1.1rem;
        }
        
        .action-card p {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .tab-container {
            display: flex;
            gap: 4px;
            margin-bottom: 24px;
            background: rgba(255, 255, 255, 0.1);
            padding: 4px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }
        
        .tab {
            padding: 12px 24px;
            border: none;
            background: transparent;
            color: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }
        
        .tab:hover:not(.active) {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.9);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .btn {
            background: linear-gradient(45deg, #e67e22, #d35400);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(230, 126, 34, 0.3);
        }
        
        .btn-ai {
            background: linear-gradient(45deg, #3498db, #2980b9);
        }
        
        .btn-ai:hover {
            box-shadow: 0 8px 24px rgba(52, 152, 219, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(45deg, #27ae60, #219a52);
        }
        
        .btn-success:hover {
            box-shadow: 0 8px 24px rgba(39, 174, 96, 0.3);
        }
        
        .btn-warning {
            background: linear-gradient(45deg, #f39c12, #e67e22);
        }
        
        .btn-danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .btn-logout {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }
        
        .job-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            transition: all 0.3s ease;
            color: white;
        }
        
        .job-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
        }
        
        .job-card h4 {
            margin-bottom: 8px;
            font-size: 1.2rem;
        }
        
        .job-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin: 12px 0;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .job-actions {
            display: flex;
            gap: 8px;
            margin-top: 16px;
            flex-wrap: wrap;
        }
        
        .application-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
        }
        
        .applicant-info h4 {
            margin-bottom: 4px;
        }
        
        .applicant-info p {
            margin: 2px 0;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .match-score {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.8rem;
        }
        
        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-pending { background: #f39c12; color: white; }
        .status-reviewing { background: #3498db; color: white; }
        .status-shortlisted { background: #27ae60; color: white; }
        .status-rejected { background: #e74c3c; color: white; }
        .status-accepted { background: #27ae60; color: white; }
        .status-active { color: #27ae60; font-weight: bold; }
        .status-inactive { color: #e74c3c; font-weight: bold; }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: white;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            backdrop-filter: blur(10px);
        }
        
        input::placeholder, textarea::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #e67e22;
            box-shadow: 0 0 0 3px rgba(230, 126, 34, 0.1);
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            margin: 5% auto;
            padding: 30px;
            width: 90%;
            max-width: 800px;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            position: relative;
            color: white;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .close {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            color: rgba(255, 255, 255, 0.7);
            transition: color 0.3s ease;
        }
        
        .close:hover {
            color: white;
        }
        
        .message {
            padding: 16px 20px;
            margin: 16px 0;
            border-radius: 8px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .message.success {
            background: rgba(39, 174, 96, 0.1);
            color: #27ae60;
            border: 1px solid rgba(39, 174, 96, 0.3);
        }
        
        .message.error {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.3);
        }
        
        .message.info {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
            border: 1px solid rgba(52, 152, 219, 0.3);
        }
        
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            padding: 40px;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .empty-state h3 {
            margin-bottom: 12px;
            color: white;
        }
        
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .chart-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
            color: white;
        }
        
        .chart-card h4 {
            margin-bottom: 16px;
            color: white;
        }
        
        .metric-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .metric-row:last-child {
            border-bottom: none;
        }
        
        .ai-insight {
            background: rgba(52, 152, 219, 0.1);
            border: 1px solid rgba(52, 152, 219, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
        }
        
        .ai-insight h4 {
            color: #3498db;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 16px;
                text-align: center;
            }
            
            .dashboard-stats {
                grid-template-columns: 1fr;
            }
            
            .quick-actions {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .tab-container {
                flex-wrap: wrap;
            }
            
            .application-card {
                flex-direction: column;
                gap: 16px;
                align-items: stretch;
            }
            
            .job-actions {
                justify-content: center;
            }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div>
                <h1>üè¢ AI Employer Dashboard</h1>
                <p>Manage jobs and find great candidates with AI assistance</p>
            </div>
            <div class="user-info">
                <div class="ai-status" id="aiStatus">
                    <div class="status-indicator"></div>
                    <span>AI Online</span>
                </div>
                <span class="role-badge">Employer</span>
                <span id="employerName">Loading...</span>
                <button class="btn btn-logout" onclick="logout()">Logout</button>
            </div>
        </div>

        <!-- Message Container -->
        <div id="message"></div>

        <!-- Dashboard Statistics -->
        <div class="dashboard-stats">
            <div class="stat-card">
                <h3>Total Jobs</h3>
                <div class="number" id="totalJobs">0</div>
                <div class="subtitle">Posted</div>
            </div>
            <div class="stat-card">
                <h3>Active Jobs</h3>
                <div class="number" id="activeJobs">0</div>
                <div class="subtitle">Live Now</div>
            </div>
            <div class="stat-card ai-powered">
                <h3>AI Applications</h3>
                <div class="number" id="totalApplications">0</div>
                <div class="subtitle">Total Received</div>
            </div>
            <div class="stat-card ai-powered">
                <h3>AI Matches</h3>
                <div class="number" id="pendingApplications">0</div>
                <div class="subtitle">Pending Review</div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions">
            <div class="action-card" onclick="showCreateJobModal()">
                <span class="icon">üìù</span>
                <h4>Post New Job</h4>
                <p>Create AI-optimized job listings</p>
            </div>
            <div class="action-card" onclick="showTab('applications')">
                <span class="icon">ü§ñ</span>
                <h4>AI Candidate Matching</h4>
                <p>Review AI-scored applications</p>
            </div>
            <div class="action-card" onclick="showTab('analytics')">
                <span class="icon">üìä</span>
                <h4>Smart Analytics</h4>
                <p>AI-powered hiring insights</p>
            </div>
            <div class="action-card" onclick="showTab('company')">
                <span class="icon">üè¢</span>
                <h4>Company Profile</h4>
                <p>Optimize for better matches</p>
            </div>
        </div>

        <!-- Main Content -->
        <div class="glass-card">
            <div class="tab-container">
                <button class="tab active" onclick="showTab('jobs')">üíº My Jobs</button>
                <button class="tab" onclick="showTab('applications')">ü§ñ AI Applications</button>
                <button class="tab" onclick="showTab('analytics')">üìä Smart Analytics</button>
                <button class="tab" onclick="showTab('company')">üè¢ Company Profile</button>
            </div>

            <!-- Jobs Tab -->
            <div id="jobsTab" class="tab-content active">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                    <h2 style="color: white;">üíº My Job Listings</h2>
                    <button class="btn btn-success" onclick="showCreateJobModal()">+ Post New Job</button>
                </div>
                
                <div class="ai-insight">
                    <h4>ü§ñ AI Job Optimization Tips</h4>
                    <div id="jobOptimizationTips">
                        <div class="loading">
                            <div class="spinner"></div>
                            <span>Loading AI insights...</span>
                        </div>
                    </div>
                </div>
                
                <div id="jobsList">
                    <div class="loading">
                        <div class="spinner"></div>
                        <span>Loading jobs...</span>
                    </div>
                </div>
            </div>

            <!-- Applications Tab -->
            <div id="applicationsTab" class="tab-content">
                <h2 style="color: white; margin-bottom: 24px;">ü§ñ AI-Powered Applications</h2>
                
                <div class="form-group">
                    <label>Filter by Job:</label>
                    <select id="jobFilter" onchange="loadApplications()">
                        <option value="">Select a job...</option>
                    </select>
                </div>
                
                <div class="ai-insight">
                    <h4>üéØ AI Candidate Insights</h4>
                    <div id="candidateInsights">
                        <p>Select a job to see AI-powered candidate analysis</p>
                    </div>
                </div>
                
                <div id="applicationsList">
                    <p style="color: rgba(255, 255, 255, 0.8);">Select a job to view applications</p>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div id="analyticsTab" class="tab-content">
                <h2 style="color: white; margin-bottom: 24px;">üìä Smart Hiring Analytics</h2>
                
                <div class="ai-insight">
                    <h4>üß† AI Market Insights</h4>
                    <div id="marketInsights">
                        <div class="loading">
                            <div class="spinner"></div>
                            <span>Generating AI insights...</span>
                        </div>
                    </div>
                </div>
                
                <div id="analyticsContent">
                    <div class="loading">
                        <div class="spinner"></div>
                        <span>Loading analytics...</span>
                    </div>
                </div>
            </div>

            <!-- Company Profile Tab -->
            <div id="companyTab" class="tab-content">
                <h2 style="color: white; margin-bottom: 24px;">üè¢ Company Profile</h2>
                
                <div class="ai-insight">
                    <h4>ü§ñ Profile Optimization Score</h4>
                    <div id="companyAnalysis">
                        <div class="loading">
                            <div class="spinner"></div>
                            <span>Analyzing company profile...</span>
                        </div>
                    </div>
                </div>
                
                <form id="companyForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Company Name:</label>
                            <input type="text" id="companyName" required placeholder="Your company name">
                        </div>
                        <div class="form-group">
                            <label>Industry:</label>
                            <input type="text" id="companyIndustry" placeholder="e.g., Technology, Finance">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Company Description:</label>
                        <textarea id="companyDescription" rows="4" placeholder="Tell candidates about your company..."></textarea>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Company Size:</label>
                            <select id="companySize">
                                <option value="">Select company size...</option>
                                <option value="1-10">1-10 employees</option>
                                <option value="11-50">11-50 employees</option>
                                <option value="51-200">51-200 employees</option>
                                <option value="201-500">201-500 employees</option>
                                <option value="500+">500+ employees</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Location:</label>
                            <input type="text" id="companyLocation" placeholder="e.g., Nairobi, Kenya">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Company Website:</label>
                        <input type="url" id="companyWebsite" placeholder="https://yourcompany.com">
                    </div>
                    
                    <div style="display: flex; gap: 12px;">
                        <button type="submit" class="btn">üíæ Update Profile</button>
                        <button type="button" class="btn btn-ai" onclick="optimizeCompanyProfile()">
                            ü§ñ AI Optimize
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Create Job Modal -->
    <div id="createJobModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>ü§ñ AI-Powered Job Creation</h2>
            <p>Create optimized job listings with AI assistance</p>
            
            <form id="createJobForm">
                <div class="form-group">
                    <label>Job Title:</label>
                    <input type="text" id="jobTitle" required placeholder="e.g., Senior Software Engineer">
                </div>
                
                <div class="form-group">
                    <label>Job Description:</label>
                    <textarea id="jobDescription" rows="4" required placeholder="Describe the role, responsibilities, and what makes it exciting..."></textarea>
                    <button type="button" class="btn btn-ai" onclick="enhanceJobDescription()" style="margin-top: 8px;">
                        ü§ñ AI Enhance Description
                    </button>
                </div>
                
                <div class="form-group">
                    <label>Requirements:</label>
                    <textarea id="jobRequirements" rows="3" placeholder="List the key requirements and qualifications..."></textarea>
                </div>
                
                <div class="form-group">
                    <label>Required Skills (comma separated):</label>
                    <input type="text" id="jobSkills" placeholder="python, react, postgresql, machine learning">
                    <button type="button" class="btn btn-ai" onclick="suggestSkills()" style="margin-top: 8px;">
                        üéØ AI Suggest Skills
                    </button>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>Experience Level:</label>
                        <select id="experienceLevel">
                            <option value="entry">Entry Level (0-2 years)</option>
                            <option value="mid">Mid Level (3-5 years)</option>
                            <option value="senior">Senior Level (6+ years)</option>
                            <option value="expert">Expert Level (10+ years)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Job Type:</label>
                        <select id="jobType">
                            <option value="full_time">Full Time</option>
                            <option value="part_time">Part Time</option>
                            <option value="contract">Contract</option>
                            <option value="internship">Internship</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Location:</label>
                    <input type="text" id="jobLocation" placeholder="e.g., Nairobi, Kenya">
                </div>
                
                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="isRemote">
                        üè† Remote Position Available
                    </label>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>Minimum Salary (KES):</label>
                        <input type="number" id="salaryMin" placeholder="e.g., 80000">
                    </div>
                    <div class="form-group">
                        <label>Maximum Salary (KES):</label>
                        <input type="number" id="salaryMax" placeholder="e.g., 150000">
                    </div>
                </div>
                
                <div style="display: flex; gap: 12px; margin-top: 20px;">
                    <button type="submit" class="btn btn-success">üöÄ Post Job</button>
                    <button type="button" class="btn btn-ai" onclick="previewJobWithAI()">
                        ü§ñ AI Preview
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:5000/api';
        let authToken = localStorage.getItem('authToken');
        let currentUser = null;
        let allJobs = [];

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            checkAuth();
            setupEventListeners();
        });

        function setupEventListeners() {
            document.getElementById('createJobForm').addEventListener('submit', handleCreateJob);
            document.getElementById('companyForm').addEventListener('submit', handleCompanyUpdate);
        }

        async function checkAuth() {
            if (!authToken) {
                window.location.href = '/';
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/auth/me`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    currentUser = data.user;
                    
                    if (currentUser.role === 'job_seeker') {
                        window.location.href = '/';
                        return;
                    } else if (currentUser.role === 'admin') {
                        window.location.href = '/admin';
                        return;
                    }
                    
                    document.getElementById('employerName').textContent = 
                        `${currentUser.first_name || ''} ${currentUser.last_name || ''}`.trim() || currentUser.email;
                    
                    await loadDashboard();
                } else {
                    window.location.href = '/';
                }
            } catch (error) {
                console.error('Auth check failed:', error);
                window.location.href = '/';
            }
        }

        async function loadDashboard() {
            await Promise.all([
                loadDashboardStats(),
                loadJobs(),
                loadJobsForFilter(),
                checkAIStatus(),
                generateJobOptimizationTips()
            ]);
        }

        async function checkAIStatus() {
            try {
                const response = await fetch(`${API_BASE}/ai/model-status`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    const status = await response.json();
                    const aiStatusEl = document.getElementById('aiStatus');
                    
                    const totalModels = Object.values(status).filter(s => s.loaded).length;
                    if (totalModels === 3) {
                        aiStatusEl.innerHTML = '<div class="status-indicator"></div><span>AI Online</span>';
                    } else {
                        aiStatusEl.innerHTML = '<div class="status-indicator" style="background: #f39c12;"></div><span>AI Limited</span>';
                    }
                }
            } catch (error) {
                console.error('AI status check failed:', error);
                document.getElementById('aiStatus').innerHTML = '<div class="status-indicator" style="background: #e74c3c;"></div><span>AI Offline</span>';
            }
        }

        async function loadDashboardStats() {
            try {
                const response = await fetch(`${API_BASE}/dashboard/stats`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const stats = data.stats || {};
                    
                    document.getElementById('totalJobs').textContent = stats.total_jobs || 0;
                    document.getElementById('activeJobs').textContent = stats.active_jobs || 0;
                    document.getElementById('totalApplications').textContent = stats.total_applications || 0;
                    document.getElementById('pendingApplications').textContent = stats.pending_applications || 0;
                }
            } catch (error) {
                console.error('Dashboard stats error:', error);
            }
        }

        async function generateJobOptimizationTips() {
            const tipsEl = document.getElementById('jobOptimizationTips');
            
            // Simulate AI tips generation
            setTimeout(() => {
                tipsEl.innerHTML = `
                    <div style="display: grid; gap: 12px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #27ae60;">‚úÖ</span>
                            <span>Use specific skill keywords to attract qualified candidates</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #3498db;">üí°</span>
                            <span>Include salary ranges for 40% more applications</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #e67e22;">‚ö†Ô∏è</span>
                            <span>Consider remote options to expand candidate pool</span>
                        </div>
                    </div>
                `;
            }, 1000);
        }

        async function loadJobs() {
            try {
                const response = await fetch(`${API_BASE}/employer/jobs`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    allJobs = data.jobs || [];
                    displayJobs(allJobs);
                }
            } catch (error) {
                console.error('Load jobs error:', error);
                document.getElementById('jobsList').innerHTML = '<div style="color: #e74c3c; text-align: center; padding: 40px;">‚ùå Error loading jobs</div>';
            }
        }

        function displayJobs(jobs) {
            const jobsList = document.getElementById('jobsList');
            
            if (jobs.length === 0) {
                jobsList.innerHTML = `
                    <div class="empty-state fade-in">
                        <h3>No jobs posted yet</h3>
                        <p>Create your first AI-optimized job listing to attract the best candidates</p>
                        <button class="btn btn-success" onclick="showCreateJobModal()" style="margin-top: 16px;">
                            üöÄ Post Your First Job
                        </button>
                    </div>
                `;
                return;
            }
            
            jobsList.innerHTML = jobs.map(job => `
                <div class="job-card fade-in">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                        <h4>${job.title}</h4>
                        <span class="status-badge status-${job.is_active ? 'active' : 'inactive'}">
                            ${job.is_active ? 'Active' : 'Inactive'}
                        </span>
                    </div>
                    
                    <div class="job-meta">
                        <span>üìç ${job.location}${job.is_remote ? ' (Remote)' : ''}</span>
                        <span>üíº ${job.job_type}</span>
                        <span>üìä ${job.experience_level}</span>
                        <span>üìù ${job.application_count || 0} applications</span>
                        <span>üìÖ ${new Date(job.created_at || job.posted_date).toLocaleDateString()}</span>
                    </div>
                    
                    ${job.salary_min && job.salary_max ? `
                        <p style="color: #27ae60; font-weight: 600; margin: 8px 0;">
                            üí∞ KES ${job.salary_min.toLocaleString()} - ${job.salary_max.toLocaleString()}
                        </p>
                    ` : ''}
                    
                    <p style="color: rgba(255, 255, 255, 0.8); margin: 12px 0;">
                        ${job.description?.substring(0, 150)}...
                    </p>
                    
                    ${job.skills_required && job.skills_required.length > 0 ? `
                        <div style="margin: 12px 0;">
                            <small style="color: rgba(255, 255, 255, 0.7);">Required Skills:</small><br>
                            ${job.skills_required.slice(0, 5).map(skill => 
                                `<span style="background: rgba(230, 126, 34, 0.2); color: #e67e22; padding: 2px 8px; border-radius: 12px; font-size: 0.8rem; margin: 2px 4px 2px 0; display: inline-block;">${skill}</span>`
                            ).join('')}
                        </div>
                    ` : ''}
                    
                    <div class="job-actions">
                        <button class="btn btn-ai" onclick="viewJobApplications(${job.id})" ${job.application_count > 0 ? '' : 'disabled'}>
                            ü§ñ AI Applications (${job.application_count || 0})
                        </button>
                        <button class="btn btn-secondary" onclick="editJob(${job.id})">‚úèÔ∏è Edit</button>
                        <button class="btn ${job.is_active ? 'btn-warning' : 'btn-success'}" onclick="toggleJobStatus(${job.id}, ${job.is_active})">
                            ${job.is_active ? '‚è∏Ô∏è Pause' : '‚ñ∂Ô∏è Activate'}
                        </button>
                        <button class="btn btn-danger" onclick="deleteJob(${job.id})">üóëÔ∏è Delete</button>
                    </div>
                </div>
            `).join('');
        }

        function showCreateJobModal() {
            document.getElementById('createJobModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('createJobModal').style.display = 'none';
            document.getElementById('createJobForm').reset();
        }

        async function handleCreateJob(event) {
            event.preventDefault();
            
            const skills = document.getElementById('jobSkills').value.split(',').map(s => s.trim()).filter(s => s);
            
            const jobData = {
                title: document.getElementById('jobTitle').value,
                description: document.getElementById('jobDescription').value,
                requirements: document.getElementById('jobRequirements').value,
                skills_required: skills,
                experience_level: document.getElementById('experienceLevel').value,
                job_type: document.getElementById('jobType').value,
                location: document.getElementById('jobLocation').value,
                is_remote: document.getElementById('isRemote').checked,
                salary_min: parseInt(document.getElementById('salaryMin').value) || null,
                salary_max: parseInt(document.getElementById('salaryMax').value) || null
            };
            
            try {
                showMessage('ü§ñ Creating AI-optimized job listing...', 'info');
                
                const response = await fetch(`${API_BASE}/jobs/`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(jobData)
                });
                
                if (response.ok) {
                    showMessage('‚úÖ Job posted successfully with AI optimization!', 'success');
                    closeModal();
                    await loadJobs();
                    await loadDashboardStats();
                } else {
                    const data = await response.json();
                    showMessage(`‚ùå ${data.error || 'Failed to post job'}`, 'error');
                }
            } catch (error) {
                console.error('Create job error:', error);
                showMessage('‚ùå Error posting job. Please try again.', 'error');
            }
        }

        async function enhanceJobDescription() {
            const description = document.getElementById('jobDescription').value;
            if (!description.trim()) {
                showMessage('‚ùå Please enter a job description first', 'error');
                return;
            }
            
            showMessage('ü§ñ AI is enhancing your job description...', 'info');
            
            // Simulate AI enhancement
            setTimeout(() => {
                const enhanced = description + '\n\nüéØ This role offers excellent growth opportunities in a collaborative environment with cutting-edge technology.';
                document.getElementById('jobDescription').value = enhanced;
                showMessage('‚úÖ Job description enhanced with AI!', 'success');
            }, 2000);
        }

        async function suggestSkills() {
            const title = document.getElementById('jobTitle').value;
            if (!title.trim()) {
                showMessage('‚ùå Please enter a job title first', 'error');
                return;
            }
            
            showMessage('üéØ AI is suggesting relevant skills...', 'info');
            
            // Simulate AI skill suggestions based on job title
            setTimeout(() => {
                const suggestions = {
                    'software engineer': 'python, javascript, sql, git, agile',
                    'data scientist': 'python, machine learning, sql, pandas, tensorflow',
                    'frontend developer': 'javascript, react, html, css, typescript',
                    'backend developer': 'python, postgresql, api, docker, microservices',
                    'full stack': 'javascript, react, node.js, postgresql, git',
                    'devops': 'docker, kubernetes, aws, ci/cd, terraform'
                };
                
                const titleLower = title.toLowerCase();
                let suggestedSkills = '';
                
                for (const [key, skills] of Object.entries(suggestions)) {
                    if (titleLower.includes(key)) {
                        suggestedSkills = skills;
                        break;
                    }
                }
                
                if (!suggestedSkills) {
                    suggestedSkills = 'communication, problem solving, teamwork, analytical thinking';
                }
                
                const currentSkills = document.getElementById('jobSkills').value;
                document.getElementById('jobSkills').value = currentSkills ? `${currentSkills}, ${suggestedSkills}` : suggestedSkills;
                showMessage('üéØ AI suggested relevant skills!', 'success');
            }, 1500);
        }

        async function previewJobWithAI() {
            const formData = new FormData(document.getElementById('createJobForm'));
            const jobData = Object.fromEntries(formData.entries());
            
            showMessage('ü§ñ AI is analyzing your job posting...', 'info');
            
            // Simulate AI analysis
            setTimeout(() => {
                const score = Math.floor(Math.random() * 30) + 70; // 70-100%
                alert(`ü§ñ AI Job Analysis
                
‚úÖ Optimization Score: ${score}%

üìä Predicted Performance:
‚Ä¢ Expected Applications: ${Math.floor(Math.random() * 50) + 20}
‚Ä¢ Quality Score: ${Math.floor(Math.random() * 20) + 80}%
‚Ä¢ Time to Fill: ${Math.floor(Math.random() * 10) + 15} days

üí° AI Recommendations:
${score < 80 ? '‚Ä¢ Add more specific technical requirements\n‚Ä¢ Include company benefits and culture\n‚Ä¢ Consider adjusting salary range' : '‚Ä¢ Great job posting! AI predicts strong candidate response\n‚Ä¢ All key elements are optimized'}
                `);
            }, 2000);
        }

        function loadJobsForFilter() {
            const select = document.getElementById('jobFilter');
            select.innerHTML = '<option value="">Select a job...</option>' + 
                allJobs.map(job => `<option value="${job.id}">${job.title} (${job.application_count || 0} applications)</option>`).join('');
        }

        async function loadApplications() {
            const jobId = document.getElementById('jobFilter').value;
            if (!jobId) {
                document.getElementById('applicationsList').innerHTML = '<p style="color: rgba(255, 255, 255, 0.8);">Select a job to view applications</p>';
                return;
            }
            
            const applicationsList = document.getElementById('applicationsList');
            applicationsList.innerHTML = '<div class="loading"><div class="spinner"></div><span>Loading AI-scored applications...</span></div>';
            
            try {
                const response = await fetch(`${API_BASE}/employer/jobs/${jobId}/applications`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    displayApplications(data.applications || []);
                    updateCandidateInsights(data.applications || []);
                }
            } catch (error) {
                console.error('Load applications error:', error);
                applicationsList.innerHTML = '<div style="color: #e74c3c; text-align: center; padding: 40px;">‚ùå Error loading applications</div>';
            }
        }

        function displayApplications(applications) {
            const appsList = document.getElementById('applicationsList');
            
            if (applications.length === 0) {
                appsList.innerHTML = `
                    <div class="empty-state">
                        <h3>No applications yet</h3>
                        <p>Applications will appear here when candidates apply to this job</p>
                        <p style="font-size: 0.9rem; color: rgba(255, 255, 255, 0.7);">üí° Tip: Share your job on social media to get more visibility</p>
                    </div>
                `;
                return;
            }
            
            // Sort by match score (highest first)
            applications.sort((a, b) => (b.match_score || 0) - (a.match_score || 0));
            
            appsList.innerHTML = applications.map(app => `
                <div class="application-card fade-in">
                    <div class="applicant-info">
                        <h4>${app.applicant?.first_name || ''} ${app.applicant?.last_name || ''}</h4>
                        <p>üìß ${app.applicant?.email || 'N/A'}</p>
                        <p>üìÖ Applied: ${new Date(app.applied_at).toLocaleDateString()}</p>
                        ${app.match_score ? `<div class="match-score">üéØ AI Match: ${app.match_score.toFixed(1)}%</div>` : ''}
                        ${app.applicant?.profile?.skills ? `
                            <p style="margin-top: 8px;"><strong>Skills:</strong> ${app.applicant.profile.skills.slice(0, 3).join(', ')}${app.applicant.profile.skills.length > 3 ? '...' : ''}</p>
                        ` : ''}
                    </div>
                    <div style="text-align: right;">
                        <span class="status-badge status-${app.status}">${app.status}</span>
                        <div style="margin-top: 12px; display: flex; flex-direction: column; gap: 8px;">
                            <select onchange="updateApplicationStatus(${app.id}, this.value)" style="width: auto; font-size: 0.8rem;">
                                <option value="">Change status...</option>
                                <option value="reviewing">Reviewing</option>
                                <option value="shortlisted">Shortlisted</option>
                                <option value="rejected">Rejected</option>
                                <option value="accepted">Accepted</option>
                            </select>
                            <button class="btn btn-ai" onclick="viewApplicantProfile(${app.applicant?.id})" style="font-size: 0.8rem; padding: 6px 12px;">
                                üë§ View Profile
                            </button>
                            ${app.cover_letter ? `
                                <button class="btn btn-secondary" onclick="viewCoverLetter('${app.cover_letter}')" style="font-size: 0.8rem; padding: 6px 12px;">
                                    üìù Cover Letter
                                </button>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function updateCandidateInsights(applications) {
            const insightsEl = document.getElementById('candidateInsights');
            
            if (applications.length === 0) {
                insightsEl.innerHTML = '<p>No applications to analyze yet</p>';
                return;
            }
            
            const avgMatchScore = applications.reduce((sum, app) => sum + (app.match_score || 0), 0) / applications.length;
            const topSkills = {};
            
            applications.forEach(app => {
                if (app.applicant?.profile?.skills) {
                    app.applicant.profile.skills.forEach(skill => {
                        topSkills[skill] = (topSkills[skill] || 0) + 1;
                    });
                }
            });
            
            const sortedSkills = Object.entries(topSkills).sort((a, b) => b[1] - a[1]).slice(0, 5);
            
            insightsEl.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                    <div>
                        <h5 style="margin-bottom: 8px;">Average AI Match Score</h5>
                        <div style="font-size: 1.5rem; color: #3498db;">${avgMatchScore.toFixed(1)}%</div>
                    </div>
                    <div>
                        <h5 style="margin-bottom: 8px;">Top Candidate Skills</h5>
                        <div style="font-size: 0.9rem;">
                            ${sortedSkills.map(([skill, count]) => `${skill} (${count})`).join(', ')}
                        </div>
                    </div>
                    <div>
                        <h5 style="margin-bottom: 8px;">Quality Assessment</h5>
                        <div style="color: ${avgMatchScore >= 75 ? '#27ae60' : avgMatchScore >= 60 ? '#f39c12' : '#e74c3c'};">
                            ${avgMatchScore >= 75 ? 'üèÜ Excellent' : avgMatchScore >= 60 ? 'üëç Good' : 'üìà Needs Improvement'}
                        </div>
                    </div>
                </div>
            `;
        }

        async function updateApplicationStatus(applicationId, newStatus) {
            if (!newStatus) return;
            
            try {
                showMessage('ü§ñ Updating application status...', 'info');
                
                const response = await fetch(`${API_BASE}/employer/applications/${applicationId}/status`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ status: newStatus })
                });
                
                if (response.ok) {
                    showMessage('‚úÖ Application status updated!', 'success');
                    loadApplications();
                    loadDashboardStats();
                } else {
                    showMessage('‚ùå Failed to update status', 'error');
                }
            } catch (error) {
                console.error('Update application status error:', error);
                showMessage('‚ùå Update failed', 'error');
            }
        }

        async function toggleJobStatus(jobId, currentStatus) {
            try {
                showMessage('üîÑ Updating job status...', 'info');
                
                const response = await fetch(`${API_BASE}/jobs/${jobId}`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ is_active: !currentStatus })
                });
                
                if (response.ok) {
                    showMessage('‚úÖ Job status updated!', 'success');
                    await loadJobs();
                    await loadDashboardStats();
                } else {
                    showMessage('‚ùå Failed to update job status', 'error');
                }
            } catch (error) {
                console.error('Job status update error:', error);
                showMessage('‚ùå Update failed', 'error');
            }
        }

        async function deleteJob(jobId) {
            if (!confirm('‚ö†Ô∏è Are you sure you want to delete this job? This action cannot be undone.')) return;
            
            try {
                showMessage('üóëÔ∏è Deleting job...', 'info');
                
                const response = await fetch(`${API_BASE}/jobs/${jobId}`, {
                    method: 'DELETE',
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    showMessage('‚úÖ Job deleted successfully!', 'success');
                    await loadJobs();
                    await loadDashboardStats();
                } else {
                    showMessage('‚ùå Failed to delete job', 'error');
                }
            } catch (error) {
                console.error('Delete job error:', error);
                showMessage('‚ùå Delete failed', 'error');
            }
        }

        async function loadAnalytics() {
            try {
                const response = await fetch(`${API_BASE}/employer/analytics`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    displayAnalytics(data);
                    generateMarketInsights(data);
                } else {
                    document.getElementById('analyticsContent').innerHTML = '<div style="color: #e74c3c; text-align: center; padding: 40px;">‚ùå Error loading analytics</div>';
                }
            } catch (error) {
                console.error('Load analytics error:', error);
                document.getElementById('analyticsContent').innerHTML = '<div style="color: #e74c3c; text-align: center; padding: 40px;">‚ùå Error loading analytics</div>';
            }
        }

        function displayAnalytics(data) {
            const analyticsContent = document.getElementById('analyticsContent');
            
            analyticsContent.innerHTML = `
                <div class="analytics-grid">
                    <div class="chart-card">
                        <h4>üìä Performance Metrics</h4>
                        <div class="metric-row">
                            <span>Average Match Score</span>
                            <span class="match-score">${data.average_match_score || 0}%</span>
                        </div>
                        <div class="metric-row">
                            <span>Applications This Month</span>
                            <span>${data.applications_this_month || 0}</span>
                        </div>
                        <div class="metric-row">
                            <span>Hire Rate</span>
                            <span style="color: ${(data.hire_rate || 0) >= 15 ? '#27ae60' : '#f39c12'};">${data.hire_rate || 0}%</span>
                        </div>
                        <div class="metric-row">
                            <span>Avg Time to Hire</span>
                            <span>${data.avg_time_to_hire || 0} days</span>
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <h4>üìã Application Status</h4>
                        ${Object.entries(data.status_breakdown || {}).map(([status, count]) => `
                            <div class="metric-row">
                                <span style="text-transform: capitalize;">${status.replace('_', ' ')}</span>
                                <span class="status-badge status-${status}" style="font-size: 0.7rem;">${count}</span>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="chart-card">
                        <h4>üéØ Top Required Skills</h4>
                        ${(data.top_skills || []).slice(0, 5).map(skill => `
                            <div class="metric-row">
                                <span>${skill.skill}</span>
                                <span style="color: #3498db;">${skill.count} jobs</span>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="chart-card">
                        <h4>üíº Job Type Performance</h4>
                        ${(data.popular_job_types || []).map(type => `
                            <div class="metric-row">
                                <span style="text-transform: capitalize;">${type.job_type.replace('_', ' ')}</span>
                                <span>${type.count} jobs</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function generateMarketInsights(data) {
            const insightsEl = document.getElementById('marketInsights');
            
            // Simulate AI market insights
            setTimeout(() => {
                const insights = [];
                
                if ((data.average_match_score || 0) < 70) {
                    insights.push('üéØ Consider refining job requirements to attract more qualified candidates');
                }
                
                if ((data.hire_rate || 0) < 10) {
                    insights.push('üìà Your hire rate is below market average. Consider adjusting salary or requirements');
                }
                
                if ((data.applications_this_month || 0) < 10) {
                    insights.push('üì¢ Low application volume detected. Consider promoting jobs on social media');
                }
                
                if (insights.length === 0) {
                    insights.push('üèÜ Great performance! Your hiring metrics are above market average');
                    insights.push('üí° Consider expanding your team to capitalize on strong candidate interest');
                }
                
                insightsEl.innerHTML = `
                    <div style="display: grid; gap: 12px;">
                        ${insights.map(insight => `
                            <div style="display: flex; align-items: flex-start; gap: 8px;">
                                <span style="font-size: 1.2rem;">${insight.split(' ')[0]}</span>
                                <span>${insight.substring(insight.indexOf(' ') + 1)}</span>
                            </div>
                        `).join('')}
                    </div>
                `;
            }, 1500);
        }

        async function loadCompanyProfile() {
            try {
                const response = await fetch(`${API_BASE}/employer/company`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    const company = await response.json();
                    document.getElementById('companyName').value = company.name || '';
                    document.getElementById('companyDescription').value = company.description || '';
                    document.getElementById('companyIndustry').value = company.industry || '';
                    document.getElementById('companySize').value = company.size || '';
                    document.getElementById('companyLocation').value = company.location || '';
                    document.getElementById('companyWebsite').value = company.website || '';
                    
                    analyzeCompanyProfile(company);
                }
            } catch (error) {
                console.error('Load company error:', error);
            }
        }

        function analyzeCompanyProfile(company) {
            const analysisEl = document.getElementById('companyAnalysis');
            
            let score = 0;
            const totalFields = 6;
            const suggestions = [];
            
            if (company.name) score++;
            else suggestions.push('Add company name');
            
            if (company.description) score++;
            else suggestions.push('Add compelling company description');
            
            if (company.industry) score++;
            else suggestions.push('Specify your industry');
            
            if (company.size) score++;
            else suggestions.push('Add company size information');
            
            if (company.location) score++;
            else suggestions.push('Add company location');
            
            if (company.website) score++;
            else suggestions.push('Add company website');
            
            const completeness = Math.round((score / totalFields) * 100);
            
            analysisEl.innerHTML = `
                <div style="display: grid; grid-template-columns: auto 1fr; gap: 16px; align-items: center;">
                    <div style="font-size: 3rem;">
                        ${completeness >= 80 ? 'üèÜ' : completeness >= 60 ? 'üéØ' : 'üìà'}
                    </div>
                    <div>
                        <h4 style="margin-bottom: 8px;">Profile Completeness: ${completeness}%</h4>
                        ${suggestions.length > 0 ? `
                            <div style="margin-top: 12px;">
                                <strong>ü§ñ AI Recommendations:</strong>
                                <ul style="margin-top: 8px; padding-left: 20px;">
                                    ${suggestions.map(s => `<li style="margin-bottom: 4px;">${s}</li>`).join('')}
                                </ul>
                            </div>
                        ` : '<p style="color: #27ae60;">‚úÖ Your company profile is optimized!</p>'}
                    </div>
                </div>
            `;
        }

        async function handleCompanyUpdate(event) {
            event.preventDefault();
            
            const companyData = {
                name: document.getElementById('companyName').value,
                description: document.getElementById('companyDescription').value,
                industry: document.getElementById('companyIndustry').value,
                size: document.getElementById('companySize').value,
                location: document.getElementById('companyLocation').value,
                website: document.getElementById('companyWebsite').value
            };
            
            try {
                showMessage('üíæ Updating company profile...', 'info');
                
                const response = await fetch(`${API_BASE}/employer/company`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(companyData)
                });
                
                if (response.ok) {
                    showMessage('‚úÖ Company profile updated successfully!', 'success');
                    analyzeCompanyProfile(companyData);
                } else {
                    showMessage('‚ùå Failed to update company profile', 'error');
                }
            } catch (error) {
                console.error('Company update error:', error);
                showMessage('‚ùå Update failed', 'error');
            }
        }

        async function optimizeCompanyProfile() {
            showMessage('ü§ñ AI is optimizing your company profile...', 'info');
            
            // Simulate AI optimization
            setTimeout(() => {
                const currentDesc = document.getElementById('companyDescription').value;
                if (!currentDesc.includes('innovative') && !currentDesc.includes('cutting-edge')) {
                    document.getElementById('companyDescription').value = currentDesc + 
                        '\n\nWe are an innovative company committed to excellence and cutting-edge technology solutions.';
                }
                
                showMessage('‚úÖ Company profile optimized with AI!', 'success');
            }, 2000);
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            if (tabName === 'applications') {
                loadJobsForFilter();
            } else if (tabName === 'company') {
                loadCompanyProfile();
            } else if (tabName === 'analytics') {
                loadAnalytics();
            }
        }

        function viewJobApplications(jobId) {
            showTab('applications');
            document.getElementById('jobFilter').value = jobId;
            loadApplications();
        }

        function editJob(jobId) {
            showMessage('‚úèÔ∏è Job editing feature coming soon!', 'info');
        }

        function viewApplicantProfile(applicantId) {
            showMessage('üë§ Applicant profile viewing - opening detailed view', 'info');
        }

        function viewCoverLetter(coverLetter) {
            alert(`üìù Cover Letter:\n\n${coverLetter}`);
        }

        function showMessage(message, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.innerHTML = `<div class="message ${type}">${message}</div>`;
            
            setTimeout(() => {
                messageDiv.innerHTML = '';
            }, 5000);
        }

        function logout() {
            localStorage.removeItem('authToken');
            window.location.href = '/';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('createJobModal');
            if (event.target === modal) {
                closeModal();
            }
        }
    </script>
</body>
</html>